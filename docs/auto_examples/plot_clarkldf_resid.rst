.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_clarkldf_resid.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_plot_clarkldf_resid.py:


====================
Clark Residual Plots
====================

This example demonstrates how to recreate the normalized residual plots in
Clarks LDF Curve-Fitting paper (2003).



.. image:: /auto_examples/images/sphx_glr_plot_clarkldf_resid_001.png
    :alt: Clark LDF Normalized Residual Plots
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    Text(0.5,0.98,'Clark LDF Normalized Residual Plots')





|


.. code-block:: default

    import chainladder as cl
    import matplotlib.pyplot as plt

    # Fit the basic model
    genins = cl.load_sample('genins')
    genins = cl.ClarkLDF().fit(genins)

    # Grab Normalized Residuals as a DataFrame
    norm_resid = genins.norm_resid_.melt(
        var_name='Development Age',
        value_name='Normalized Residual').dropna()

    # Grab Fitted Incremental values as a DataFrame
    incremental_fits = genins.incremental_fits_.melt(
        var_name='Development Age',
        value_name='Expected Incremental Loss').dropna()

    # Plot the residuals vs Age and vs Expected Incrementals
    fig, ((ax0, ax1)) = plt.subplots(ncols=2, figsize=(15,5))
    # Left plot
    norm_resid.plot(
        x='Development Age', y='Normalized Residual',
        kind='scatter', grid=True, ylim=(-4, 4), ax=ax0)
    # Right plot
    incremental_fits.merge(
        norm_resid, how='inner', left_index=True, right_index=True).plot(
        x='Expected Incremental Loss', y='Normalized Residual',
        kind='scatter', grid=True, ylim=(-4, 4), ax=ax1)
    fig.suptitle("Clark LDF Normalized Residual Plots");


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.388 seconds)


.. _sphx_glr_download_auto_examples_plot_clarkldf_resid.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_clarkldf_resid.py <plot_clarkldf_resid.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_clarkldf_resid.ipynb <plot_clarkldf_resid.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
